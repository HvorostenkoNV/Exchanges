@startuml

namespace Main.Exchange.DataProcessors #BBB {
    class Manager {
        +getCollector(Procedure $procedure) : Collector
        +getMatcher(Procedure $procedure) : Matcher
        +getCombiner(Procedure $procedure) : Combiner
        +getProvider(Procedure $procedure) : Provider
    }

    interface Processor {
        +__construct(Procedure $procedure)
        +getProcedure() : Procedure
    }

    abstract AbstractProcessor {
        +__construct(Procedure $procedure)
        +getProcedure() : Procedure
    }

    class Collector {
        +collectData() : CollectedData
    }

    class Matcher {
        +matchItems(CollectedData $data) : MatchedData
    }

    class Combiner {
        +combineItems(MatchedData $data) : CombinedData
    }

    class Provider {
        +provideData(CombinedData $data) : ProviderResult
    }
    /' ------------------------------------------- '/
    /' ----------------- Results ----------------- '/
    /' ------------------------------------------- '/
    namespace Results #FFF {
        interface Result {

        }
        /' ---------------------------- '/
        /' ------- CollectedData ------ '/
        /' ---------------------------- '/
        class CollectedData < extends Main.Data.MapData > {
            +set(Participants.Participant $key, Participants.Data.ProvidedData $value) : void
            +get(Participants.Participant $key) : ?Participants.Data.ProvidedData
        }

        note bottom of CollectedData
        [
            Participant =>
            [
                [
                    participantField => participantFieldValue,
                    participantField => participantFieldValue
                ],
                [
                    participantField => participantFieldValue,
                    participantField => participantFieldValue
                ]
            ],
            Participant =>
            [
                [
                    participantField => participantFieldValue,
                    participantField => participantFieldValue
                ],
                [
                    participantField => participantFieldValue,
                    participantField => participantFieldValue
                ]
            ]
        ]
        endnote
        /' ---------------------------- '/
        /' ------- MatchedData ------ '/
        /' ---------------------------- '/
        class MatchedData < extends Main.Data.QueueData > {
            +pop() : Data.MatchedItem
            +push(Data.MatchedItem $data) : void
        }

        note bottom of MatchedData
        [
            commonItem =>
            [
                Participant =>
                [
                    participantField => participantFieldValue,
                    participantField => participantFieldValue
                ],
                Participant =>
                [
                    participantField => participantFieldValue,
                    participantField => participantFieldValue
                ]
            ],
            commonItem =>
            [
                Participant =>
                [
                    participantField => participantFieldValue,
                    participantField => participantFieldValue
                ],
                Participant =>
                [
                    participantField => participantFieldValue,
                    participantField => participantFieldValue
                ]
            ]
        ]
        endnote
        /' ---------------------------- '/
        /' ------- CombinedData ------- '/
        /' ---------------------------- '/
        class CombinedData < extends Main.Data.QueueData > {
            +pop() : Data.CombinedItem
            +push(Data.CombinedItem $data) : void
        }

        note bottom of CombinedData
        [
            commonItem =>
            [
                commonField => commonFieldValue,
                commonField => commonFieldValue
            ],
            commonItem =>
            [
                commonField => commonFieldValue,
                commonField => commonFieldValue
            ]
        ]
        endnote
        /' ---------------------------- '/
        /' ------ ProviderResult ------ '/
        /' ---------------------------- '/
        class ProviderResult < extends Main.Data.MapData > {
            +set(Participants.Participant $key, bool $value) : void
            +get(Participants.Participant $key) : bool
        }
        /' ---------------------------- '/
        /' --------- Relations -------- '/
        /' ---------------------------- '/
        Result  <|--    CollectedData
        Result  <|--    MatchedData
        Result  <|--    CombinedData
        Result  <|--    ProviderResult
    }
    /' ------------------------------------------- '/
    /' ------------------ Data ------------------- '/
    /' ------------------------------------------- '/
    namespace Data #FFF {
        class MatchedItem < extends Main.Data.MapData > {
            +set(Participants.Participant $key, Participants.Data.ItemData $value) : void
            +get(Participants.Participant $key) : ?Participants.Data.ItemData
        }

        class CombinedItem < extends Main.Data.MapData > {
            +set(Procedures.Fields.ProcedureField $key, mixed $value) : void
            +get(Procedures.Fields.ProcedureField $key) : mixed
        }
    }
    /' ------------------------------------------- '/
    /' ---------------- Relations ---------------- '/
    /' ------------------------------------------- '/
    Manager             -       Processor
    Processor           <|--    AbstractProcessor
    AbstractProcessor   <|--    Collector
    AbstractProcessor   <|--    Matcher
    AbstractProcessor   <|--    Combiner
    AbstractProcessor   <|--    Provider

    Main.Exchange.DataProcessors.Results.MatchedData    o-- Main.Exchange.DataProcessors.Data.MatchedItem
    Main.Exchange.DataProcessors.Results.CombinedData   o-- Main.Exchange.DataProcessors.Data.CombinedItem

    Processor o-- Main.Exchange.DataProcessors.Results.Result
}

@enduml